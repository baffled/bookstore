0014001500160017001D001E001F0021002200230025002600270029002A002B002D002E003000310032003A003B003C00420043004400450046004C004F00500051005200530054005500560057005A005B005C005D005E005F00600061006200650066006700680069006A006B006C006D007100720073007400750076007700780079007B007C007D007E007F0081008200830084008600870089008A008B008E008F0093009400950096009700980099009A009B009D009E009F00A000A100A200A400A500A600A700AA00AB00AC00AD00AF
00000006000C0012001400300037003F005B0062006A0086008D009500B100B800C000E100F301180138013A015F017F0181018D019901A501BF01C101C801D401F40214023402540274029402B402D902E50305032503450365038503A503C503EA03F60416043604560476049604B604D604FB0507052705470567058705A705C705E7060C0648065406B8071C0752075E077E079E07D407E707ED07F90805082708440870089108C908F008F0090C09380964099009BC09DE0A1B0A470A730A9F0ACB0AF70B230B4F0B7B0B8C0BA40BA40BAA
ýýýýýýýýýýýýýýýýýýýýGoSub InitýGoSub ShouldCreateOrdersýGoSub WrapUpýSTOPýýýýýInit:ýOpen 'U2_BOOKS' To U2_BOOKS Elseý  Error 'Cannot open U2_BOOKS'ý  STOPýEndýOpen 'U2_ORDERS' To U2_ORDERS Elseý  Error 'Cannot open U2_ORDERS'ý  STOPýEndýOpen 'U2_PURCHASES' To U2_PURCHASES Elseý  Error 'Cannot open U2_PURCHASES'ý  STOPýEndýOpen 'U2_PARAMS' To U2_PARAMS Elseý  Error 'Cannot open U2_PARAMS'ý  STOPýEndýRead OrigRec From U2_PARAMS,'NEXT.PO' Elseý  OrigRec = ''ýEndýWrite OrigRec On U2_PARAMS,'NEXT.PO.bak'ýDelete U2_PARAMS,'NEXT.PO'ýReturnýýýýýýWrapUp:ýý   Write OrigRec On U2_PARAMS,'NEXT.PO'ý   Delete U2_PARAMS,'NEXT.PO.bak'ý   ReturnýýýýýCallSub:ý  Counter = 0ý  ErrText = ''ý  PurchaseOrders = ''ý  Call u2_createDailyPOs(OrderDate, PurchaseOrders, ErrText)ýReturnýýýýýShouldCreateOrders:ý  Announce "Should CreateOrders"ý  ýý  BookRec = ''ýBookRec<1> = 'Book 1'ýBookRec<3> = '1000000001'ýBookRec<9> = 10ýBookRec<10> = 5ýBookRec<14> = 1099ýBookRec<16> = 'BOOKA'ýBookRec<13> = 'NN'  ý  Write BookRec On U2_BOOKS, '1'ý  ýý  BookRec = ''ýBookRec<1> = 'Book 2'ýBookRec<3> = '1000000002'ýBookRec<9> = 0ýBookRec<10> = 1ýBookRec<14> = 1199ýBookRec<16> = 'BOOKB'ýBookRec<13> = 'NN'ý  Write BookRec On U2_BOOKS, '2'ý  ýý  BookRec = ''ýBookRec<1> = 'Book 3'ýBookRec<3> = '1000000003'ýBookRec<9> = 1ýBookRec<10> = 5ýBookRec<14> = 1299ýBookRec<16> = 'BOOKC'ýBookRec<13> = 'BB'ý  Write BookRec On U2_BOOKS, '3'ý  ý  ýý  BookRec = ''ýBookRec<1> = 'Book 4'ýBookRec<3> = '1000000004'ýBookRec<9> = 0ýBookRec<10> = 5ýBookRec<14> = 1399ýBookRec<16> = 'BOOKD'ýBookRec<13> = 'BB'  ý  Write BookRec On U2_BOOKS, '4'ý  ý  Key = Date() : "*" : Time()ý  OrderRec = ''ýOrderRec<10> = 1:@VM:2:@VM:3ýOrderRec<11> = 1:@VM:2:@VM:3ý  Write OrderRec On U2_ORDERS, Key : "*001"ý  ý  OrderRec = ''ýOrderRec<10> = 4ýOrderRec<11> = 1ý  Write OrderRec On U2_ORDERS, Key : "*002"ý  ý  OrderDate = Date()ý  GoSub CallSubý  ý  AssertFull "Should have purchase orders", PurchaseOrdersý  AssertEmpty "Should have no errors", ErrTextý  AssertIs "Should have two POs", DCount(PurchaseOrders,@FM), 2ý  ýý  NewBookRec = Read("U2_BOOKS", 1)ýAssertIs "Should have decremented book 1", NewBookRec<9>,9ý  ý  ýý  For ThisPO = 1 To 2ý  PORec = Read("U2_PURCHASES", PurchaseOrders<ThisPO>)ýSupplierId = PORec<2>ý  Begin Caseý     Case SupplierId = 'NN'ýAssertIs "Should have book 2", PORec<10>, 2ýAssertIs "Should have ISBN 2", PORec<11>, '1000000002'ýAssertIs "Should have price 2", PORec<12>, 1199ýAssertIs "Should have Qty for 2", PORec<14>, 3ý        ý     Case SupplierId = 'BB'ýAssertIs "Should have two books", DCOunt(PORec<10>,@VM), 2ýAssertIs "Should have book 3", PORec<10,1>, 3ýAssertIs "Should have ISBN 3", PORec<11,1>, '1000000003'ýAssertIs "Should have price 3", PORec<12, 1>, 1299ýAssertIs "Should have Qty for 3", PORec<14, 1>, 5ý        ýAssertIs "Should have book 4", PORec<10,2>, 4ýAssertIs "Should have ISBN 4", PORec<11,2>, '1000000004'ýAssertIs "Should have price 4", PORec<12, 2>, 1399ýAssertIs "Should have Qty for 4", PORec<14, 2>, 5ý        ý        ý     Case 1ý        Error 'Bad supplier id for PurchaseOrder ' : ThisPOý  End Caseý  Nextý  ý  Returný  
