00080009000A000B000C000E0012001300140017001B001C001D001F002200240025002600280029002A002B002C002D002E002F0030003100320033003400350037003B003C003D003E003F0040004200450046004700480049004A004B004E0051005200530055005600580059005B005D
00000006000C00120018001E0020003C0043004B004D0059006500840086008D009900A500AB00D70103012F015B018701B301DF020B02370263028F02BB02E7030E031003170323032F0349035503610363036A037603820388039403A003A203A903B503C103C703E40401041604330450
ýýýýýýýýGoSub InitýGoSub ShouldGetDataýGoSub ShouldGiveErrorWithMissingKeyýGOSub ShouldGetImageýGoSub ShouldLockAndReleaseTitleýýSTOPýýInit:ýý   Open 'U2_BOOKS' To U2_BOOKS Elseý     Crt 'Cannot open U2_BOOKS'ý     STOPý   Endý   ý   RETURNý   ýCallSub:ýý  BookData = ''ý  ErrText = ''ý   Call u2_getBookData(BookId, LockFlag, BookData, ErrText)ý   ýReturnýýShouldGetData:ý  Announce 'Should get the base data'ý  ý  BookId = 220ý  LockFlag = @Falseý  GoSub CallSubý  ýAssertIs "Should be Chocolat", BookData<1>,'Chocolat'ýAssertIs "Should have author", BookData<3>,'Joanna Harris'ýAssertIs "Should have ISBN",BookData<4>,'1840323345'ýAssertIs "Should have DEPT", BookData<5>,'ADULT'ýAssertIs "Should have GENRE", BookData<6>,'FICTION'ýAssertIs "Should have MEDIA",BookData<7>,'CD'ýAssertCont "Should have PUBLISHER",BookData<9>,'Hodder'ýAssertIs "Should have SALE PRICE",BookData<10>,'1499'ýAssertIs "Should have STOCK LEVEL",BookData<11>,'1'ýAssertIs "Should have MIN ORDER",BookData<12>,'5'ýAssertIs "Should have TAX CODE",BookData<15>,'N'ýAssertIs "Should have SUPPLIER",BookData<18>,'PEPPER PRESS'ýAssertIs "Should have PURCH PRICE",BookData<19>,'499'ýAssertFull "Should have LONG DESCRIPTION",BookData<20>ý  ýReturnýýShouldGetImage:ýýAnnounce 'Should get the book image'ý  ImageData = ''ý  BookId = 220ý  Call u2_getBookImage(BookId, ImageData, ErrText)ý  AssertFull "Should have image", ImageDataý  AssertEmpty "Should have no error", ErrTextý  ýReturnýýShouldGiveErrorWithMissingKey:ý   Announce "Should return error with a missing key"ý   BookId = -1ý   LockFlag = @Falseý   GoSub CallSubý   AssertEmpty "Should have no data", BookDataý   AssertFull "Should have an error", ErrTextýReturnýýShouldLockAndReleaseTitle:ý  Announce 'Should lock and release title'ý  ý ý  BookId = 220ý  LockFlag = @Trueý  GoSub CallSubý  ý  Result = RecordLocked(U2_BOOKS, BookId)  ý  Assert "Should have lock set", Result <> 0ý  ý  Call u2_releaseBook(BookId, ErrText)ý  Result = RecordLocked(U2_BOOKS, BookId)ý  ý  Assert "Should have lock released", Result = 0ý  ý  Returný  ý
